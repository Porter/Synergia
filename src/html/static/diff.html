<div contenteditable="true" class="main" id="section1" style="background-color: yellow; width:100%; height:30%; overflow:scroll"              ><div id="0"><font id="0-0" color="#888888">sfedfadassfaftffasfsadfasdfasdfsadfasdfsadf</font></div><div id="1"><font id="1-0" color="#888888">s</font></div><div id="2"><font id="2-0" color="#888888">sadfsadfsadf</font></div><div id="3"><font id="3-0" color="#888888">sadfsadfsadf</font></div><div id="4"><font id="4-0" color="#888888">sadf</font></div><div id="5"><font id="5-0" color="#008a00">dsfasdffsad</font><font id="5-1" color="#888888"><br></font></div><div id="6"><font id="6-0" style="line-height: 25.7142868041992px;" color="#008a00">fsfs</font><font id="6-1" style="line-height: 25.7142868041992px;" color="#888888">adfsadfasdfsadfsadfsadfsdfsadfsadfasdfsadfs</font></div><div id="7"><font style="line-height: 25.7142868041992px;" id="7-0" color="#008a00">sdfsadfsadfasdfsadfsadfsadd</font><font style="line-height: 25.7142868041992px;" id="7-1" color="#888888"><br></font></div><div id="8"><font style="line-height: 25.7142868041992px;" id="8-0" color="#008a00">fsfsadfsadfasdfsadfsadfsadd</font><font style="line-height: 25.7142868041992px;" id="8-1" color="#888888"><br></font></div><div id="9"><font style="line-height: 25.7142868041992px;" id="9-0" color="#008a00">fsfsadfsadfasdfsadfsadfsads</font><font style="line-height: 25.7142868041992px;" id="9-1" color="#888888"><br></font></div><div id="10"><font style="line-height: 25.7142868041992px;" id="10-0" color="#888888">fs</font><font style="line-height: 25.7142868041992px;" id="10-1" color="#008a00">fs</font><font style="line-height: 25.7142868041992px;" id="10-2" color="#888888">adfsadfasdfsadfsadfsadf</font><font style="line-height: 25.7142868041992px;" id="10-3" color="#888888"><br></font></div></div>

<div contenteditable="true" class="main" id="section2" style="background-color: yellow; overflow:scroll; width:100%; height:30%; margin-top:5%;"><div id="0"><font id="0-0" color="#888888">sfedfadassfaftffasfsadfasdfasdfsadfasdfsadf</font></div><div id="1"><font id="1-0" color="#888888">s</font></div><div id="2"><font id="2-0" color="#888888">sadfsadfsadf</font></div><div id="3"><font id="3-0" color="#888888">sadfsadfsadf</font></div><div id="4"><font id="4-0" color="#888888">sadf</font></div><div id="5"><font id="5-0" color="#008a00">dsfasdffsadfs</font><font id="5-1" color="#888888"><br></font></div><div id="6"><font id="6-0" style="line-height: 25.7142868041992px;" color="#008a00">fsfs</font><font id="6-1" style="line-height: 25.7142868041992px;" color="#888888">adfsadfasdfsadfsadfsadfsdfsadfsadfasdfsadfs</font></div><div id="7"><font style="line-height: 25.7142868041992px;" id="7-0" color="#008a00">sdfsadfsadfasdfsadfsadfsadd</font><font style="line-height: 25.7142868041992px;" id="7-1" color="#888888"><br></font></div><div id="8"><font style="line-height: 25.7142868041992px;" id="8-0" color="#008a00">fsfsadfsadfasdfsadfsadfsadd</font><font style="line-height: 25.7142868041992px;" id="8-1" color="#888888"><br></font></div><div id="9"><font style="line-height: 25.7142868041992px;" id="9-0" color="#008a00">fsfsadfsadfasdfsadfsadfsads</font><font style="line-height: 25.7142868041992px;" id="9-1" color="#888888"><br></font></div><div id="10"><font style="line-height: 25.7142868041992px;" id="10-0" color="#888888">fs</font><font style="line-height: 25.7142868041992px;" id="10-1" color="#008a00">fs</font><font style="line-height: 25.7142868041992px;" id="10-2" color="#888888">adfsadfasdfsadfsadfsadf</font><font style="line-height: 25.7142868041992px;" id="10-3" color="#888888"><br></font></div></div>



<button onclick="go()">go</button>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

<script src="change.js"></script>

<script type="text/javascript">
	
	function time() {
		var d= new Date();
		return d.getTime();
	}


	node1 = $('#section1')[0];
	node2 = $('#section2')[0];

	function go() {
		
		setColor('#ff0000');
		var t = time();
		
		var c = getNodeChanges(node1, node2, null);
		
		
		
		console.log(JSON.stringify(c));
		console.log(c[0]);
		
		if (c[0]) {
			c[0][1] = createNodeTree(c[0][1]);
		}
		
		setStructureDifferences(node1, c[0]);
		
		console.log(node2.textContent);
		console.log(JSON.stringify(c[1]));
		console.log("applying " + JSON.stringify(c[1]) + " to " + node1.textContent);
		var text = executeChanges(node1.textContent, c[1]);
		console.log("gets us: " + text);
		
		console.log(text);
		
		node1.textContent = text;
		
		console.log(time() - t);
	}
	
</script>