<!doctype html>
<html>
	<head>
		<title>Connectivity</title>
		<script src="/socket.io-1.2.0.js"></script>
		<script src="/jquery-1.11.1.js"></script>
		<script type="text/javascript" src="/bootstrap/js/bootstrap.min.js"></script>
		
		<link href="/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	</head>
	
	<body>
		
		<center>

			<h2>Choose a Document</h2>

			<br/><br/>


			<ul style="list-style-type: none;">

			{% for doc in documents %}
			  <li> <a href="/docs/view?doc={{ doc._id.toString() }}&title={{ doc.name }}"> {{ doc.name }} </a></li>
			{% endfor %}

			</ul>

			<form onsubmit="javascript:thing(); return false;">
				<input id="name" type="text">
				<input type="submit" value="Create">
			</form>

		</center>
		
		
		
		
	</body>

	<script type="text/javascript">

		status = 0;

		function onTimeout() {
			alert("timed out");
		}


		function thing () {
			var doc = $('#name').val();


			var socket = io();

			var to = setTimeout(onTimeout, 5 * 1000);

			socket.on('connect', function () {
				status = 1;
			    socket.emit('createDocument', doc, function (data) {
			    	clearTimeout(to);

			    	if (data == -1) {
				    	alert("ajsldfj");
				    }
				    else {
				    	window.location.href = '/docs/view?doc=' + data;
				    }
			    });
			});


		}

	</script>
	
	
</html>